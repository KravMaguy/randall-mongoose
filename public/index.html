<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Client Data</title>
</head>
<body>
    <h1>Please fill data in the form below:</h1>
    <form id="form" method="POST" action="">
        <label>Name:<input type="text" name="client-name" required></label>
        <br>
        <label>Email:<input type="text" name="client-email" required></label>
        <br>
        <label>Comment:<br><textarea name="comment"></textarea></label>
        <br>
        <input type="submit" value="Submit">
    </form>
    <a href="/view-feedbacks">View feedbacks</a>
    <ul id=comments></ul>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
//       $.ajax({
//         url: '/view-feedbacks',
//         type: 'GET'
//       })
//       .done(function(feedbacks) {
//         console.log(feedbacks)
//         for(let i=0; i<feedbacks.comments.length; i++){
//             $('#comments').append(feedbacks.comments[i].email)
//             console.log(feedbacks.comments[i].email);
//         }
//         console.log(feedbacks.comments.length)

// })
      
//       .fail(function(e) {
//         console.log(e);
//       });
//var url= window.location.href
document.getElementById("form").addEventListener('submit', function(e) {
  e.preventDefault();
 // fetch(`${url}`)
 fetch('/route')
.then((response => {
         status = response.status;
         return response.json()
     }))
    .then(response => {
       console.log({
            response: response,
            status: status
        }) 
        console.log(response.comments)
        for (x in response.comments) {
        document.getElementById("comments").innerHTML += response.comments[x].email+'<br>'+response.comments[x].comment+'<br>';
}
    }).catch(err => console.log('fetch didn\'t succeed'+err));

})

    </script>

</body>
</html>